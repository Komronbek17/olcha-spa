<template>
  <div class="flex">
    <ul class="flex">
      <li
        v-for="n in max"
        :key="n"
        class="mr-1"
        @click="changeRating(n)"
      >
        <svg
          :width="sizes.width"
          :height="sizes.height"
          viewBox="0 0 17 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            :d="svgMode"
            :fill="n <= selected ? '#FF730B' : '#C1C1C1'"
          />
        </svg>
      </li>
    </ul>
  </div>
</template>

<script>
import VueTypes from 'vue-types'

export default {
  name: 'Rating',
  props: {
    max: VueTypes.number.def(5),
    rating: VueTypes.oneOfType([
      VueTypes.number.def(0),
      VueTypes.string.def('0')
    ]),
    mode: VueTypes.string.def(''),
    size: VueTypes.string.def('md'),
    readonly: VueTypes.bool.def(true)
  },
  data () {
    return {
      selected: this.rating
    }
  },
  computed: {
    svgMode () {
      return this.mode === 'outline'
        ? 'M8.4998 11.7059C8.62567 11.7059 8.75155 11.736 8.86634 11.7954L11.8501 13.355L11.2825 10.064C11.2374 9.80591 11.3237 9.54308 11.5121 9.36021L13.9156 7.03587L10.5882 6.55137C10.3309 6.51416 10.1085 6.35346 9.99288 6.12071L8.4998 3.11712L7.00672 6.12071C6.89113 6.35346 6.66867 6.51416 6.41138 6.55137L3.08401 7.03587L5.48751 9.36021C5.67592 9.54308 5.76222 9.80591 5.71709 10.064L5.14947 13.355L8.13326 11.7954C8.24805 11.736 8.37392 11.7059 8.4998 11.7059ZM12.9031 15.589C12.7772 15.589 12.6513 15.5598 12.5365 15.4996L8.4998 13.3906L4.4631 15.4996C4.19551 15.6389 3.87251 15.6144 3.63105 15.437C3.38722 15.2597 3.2661 14.9597 3.31676 14.6628L4.08626 10.2073L0.824596 7.05251C0.606887 6.84272 0.529304 6.52763 0.621929 6.24026C0.713762 5.95288 0.962346 5.74388 1.2608 5.70034L5.7741 5.04484L7.79047 0.986758C8.05805 0.448424 8.94155 0.448424 9.20914 0.986758L11.2255 5.04484L15.7388 5.70034C16.0373 5.74388 16.2858 5.95288 16.3777 6.24026C16.4703 6.52763 16.3927 6.84272 16.175 7.05251L12.9133 10.2073L13.6828 14.6628C13.7335 14.9597 13.6124 15.2597 13.3686 15.437C13.2316 15.5384 13.0677 15.589 12.9031 15.589Z'
        : 'M11.397 12.9998C11.2847 12.9998 11.1725 12.9744 11.0701 12.9223L7.47067 11.0952L3.87122 12.9223C3.63262 13.043 3.34461 13.0217 3.12931 12.8681C2.91189 12.7145 2.80388 12.4545 2.84906 12.1974L3.53521 8.33755L0.626849 5.60454C0.432723 5.4228 0.363543 5.14984 0.446135 4.90089C0.528021 4.65194 0.749677 4.47088 1.01581 4.43316L5.04021 3.8653L6.83817 0.34977C7.07677 -0.11659 7.86457 -0.11659 8.10317 0.34977L9.90113 3.8653L13.9255 4.43316C14.1917 4.47088 14.4133 4.65194 14.4952 4.90089C14.5778 5.14984 14.5086 5.4228 14.3145 5.60454L11.4061 8.33755L12.0923 12.1974C12.1375 12.4545 12.0295 12.7145 11.812 12.8681C11.6899 12.9559 11.5438 12.9998 11.397 12.9998Z'
    },
    sizes () {
      return this.size === 'sm'
        ? { width: '14', height: '13' }
        : { width: '23', height: '22' }
    }
  },
  methods: {
    changeRating (n) {
      if (!this.readonly) {
        this.selected = n
        this.$emit('change:rating', n)
      }
    }
  }
}
</script>
